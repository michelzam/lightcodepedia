module:
  - doc: Pets
    icon: "üêæ"

imports:
  - !Module
    name: blocks
  - !Module
    name: inspectors
  - !Module
    name: tutorial101
  - !Module
    name: streamlit
    as_name: st

classes:

  - !Class
    name: Pet
    bases: [ kore.Object ]
    attributes:
      - !Attribute
        name: name
        type: str
      - !Attribute
        name: distance
        type: int
        default: 20
      - !Attribute
        name: speed
        type: int
        default: 1
    methods:
      - !Method
        name: run
        code: |
          placeholder = st.empty()
          for _ in range(5):
            placeholder.markdown(self.come())
            import time
            time.sleep(0.5)

      - !Method
        name: come
        doc: Come closer
        code: |
          self.distance -= self.speed
          return self.display()

      - !Method
        name: display
        doc: Displays the pet at its current distance
        code: |
          return f"{self.distance * '-'} {self.name}"

  - !Class
    name: RoboPet
    bases: [ Pet ]
    methods:
      - !Method
        doc: Customized display for the robo pet with it's robot emoji
        name: display
        code: |
          return f"{self.distance * '-'} ü§ñ {self.name}"


  - !Class
    name: Race
    bases: [ kore.Object ]
    attributes:
      - !Attribute
        name: name
        type: str
      - !Attribute
        name: distance
        type: int
        default: 20
      - !Attribute
        name: participants
        type: List[Pet]
    methods:
      - !Method
        name: ready
        doc: Reinitialize the race
        code: |
          for p in self.participants:
            p.distance = self.distance

      - !Method
        name: run
        doc: Run the race
        code: |
          import time
          placeholder = st.empty()
          finish: bool = False

          while not finish:
            positions = []
            for p in self.participants:
              positions.append(p.come())
              if p.distance <= 0:
                finish = True 
                positions.append(f"üèÜ {p.name} wins the race!")          
            placeholder.text("\n".join(positions))
            time.sleep(0.5)


instances:

  - !Scene
    title: "Pet race"
    icon: "üèÅ"
    lines: [1, 3, 2, 1]
    as_name: scene

  - !Text
    title: üêïüí®
    border: False
    text: |
      **For** a curious student
      **who** wants to organize a pet race
      **our app** shows a way to manage it
      **while** having fun

    footer: |
      _ü™§ Adjust values, and hover over buttons to see the pets run!_

  - !Pet &lucky
    name: üêï Lucky
    speed: 2

  - !RoboPet &muppets
    name: üê© Muppets
    distance: 12

  - !Race &uwmrace
    name: üèá UWM Race
    participants: [*lucky, *muppets]

  - !Inspector
    source: *lucky
    # border: False

  - !Inspector
    source: *muppets

  - !Inspector
    source: *uwmrace
